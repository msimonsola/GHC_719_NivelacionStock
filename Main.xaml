<Activity mc:Ignorable="sap sap2010" x:Class="Main" mva:VisualBasic.Settings="{x:Null}" sap:VirtualizedContainerService.HintSize="1044,1025" sap2010:WorkflowViewState.IdRef="Main_1" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=mscorlib" xmlns:sd="clr-namespace:System.Diagnostics;assembly=System" xmlns:sd1="clr-namespace:System.Data;assembly=System.Data" xmlns:snm="clr-namespace:System.Net.Mail;assembly=System" xmlns:ss="clr-namespace:System.Security;assembly=mscorlib" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="29">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>DocumentFormat.OpenXml.Drawing.Charts</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>Microsoft.Office.Core</x:String>
      <x:String>Microsoft.Office.Interop.Excel</x:String>
      <x:String>System.Net</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="76">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>UiPath.CV.Activities</AssemblyReference>
      <AssemblyReference>UiPath.IntelligentOCR</AssemblyReference>
      <AssemblyReference>UiPath.Python</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System.Configuration.Install</AssemblyReference>
      <AssemblyReference>UiPath.Cryptography</AssemblyReference>
      <AssemblyReference>UiPath.Java.Activities</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Plugin.Workflow</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>DocumentFormat.OpenXml</AssemblyReference>
      <AssemblyReference>UiPath.Word</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>BalaReva.Excel</AssemblyReference>
      <AssemblyReference>Excel.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.Office.Interop.Excel</AssemblyReference>
      <AssemblyReference>Excel_ExtensionsLib</AssemblyReference>
      <AssemblyReference>ExcelActivities</AssemblyReference>
      <AssemblyReference>Utility</AssemblyReference>
      <AssemblyReference>Microsoft.VisualStudio.Services.Common</AssemblyReference>
      <AssemblyReference>UiPath.CV</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <StateMachine InitialState="{x:Reference __ReferenceID5}" DisplayName="State machine" sap:VirtualizedContainerService.HintSize="1024,925" sap2010:WorkflowViewState.IdRef="StateMachine_1">
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <av:Point x:Key="ShapeLocation">0,2.5</av:Point>
        <x:Double x:Key="StateContainerWidth">990</x:Double>
        <x:Double x:Key="StateContainerHeight">889</x:Double>
        <av:PointCollection x:Key="ConnectorLocation">60,43.75 90,43.75 90,42 108,42</av:PointCollection>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <State x:Name="__ReferenceID0" DisplayName="Fin Flujo" sap:VirtualizedContainerService.HintSize="200,103" sap2010:WorkflowViewState.IdRef="State_1" IsFinal="True">
      <State.Entry>
        <Sequence sap:VirtualizedContainerService.HintSize="254,360" sap2010:WorkflowViewState.IdRef="Sequence_11">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Sequence DisplayName="Clean Variables Globales" sap:VirtualizedContainerService.HintSize="216,68" sap2010:WorkflowViewState.IdRef="Sequence_148">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </Sequence>
          <Sequence DisplayName="Cierre" sap:VirtualizedContainerService.HintSize="216,68" sap2010:WorkflowViewState.IdRef="Sequence_33">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <InvokeMethod DisplayName="Stop Tiempo Flujo" sap:VirtualizedContainerService.HintSize="330,134" sap2010:WorkflowViewState.IdRef="InvokeMethod_21" MethodName="Stop">
              <InvokeMethod.TargetObject>
                <InArgument x:TypeArguments="sd:Stopwatch">[swFlujo]</InArgument>
              </InvokeMethod.TargetObject>
            </InvokeMethod>
            <Assign sap:VirtualizedContainerService.HintSize="330,60" sap2010:WorkflowViewState.IdRef="Assign_64">
              <Assign.To>
                <OutArgument x:TypeArguments="ui:GenericValue">[timeResult]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="ui:GenericValue">["Flujo Completo: " + swFlujo.Elapsed.ToString("mm\:ss") + newLine]</InArgument>
              </Assign.Value>
            </Assign>
            <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="330,93" sap2010:WorkflowViewState.IdRef="LogMessage_16" Level="Info" Message="[&quot;Tiempo &quot; + timeResult]" />
          </Sequence>
          <ui:CommentOut DisplayName="Comment out" sap:VirtualizedContainerService.HintSize="216,52" sap2010:WorkflowViewState.IdRef="CommentOut_4">
            <ui:CommentOut.Body>
              <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="518,455" sap2010:WorkflowViewState.IdRef="Sequence_71">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <If Condition="[strEndMsg = &quot;&quot;]" DisplayName="If     Ver si se produjo algún error" sap:VirtualizedContainerService.HintSize="480,363" sap2010:WorkflowViewState.IdRef="If_1">
                  <If.Then>
                    <Sequence DisplayName="No hubo errores" sap:VirtualizedContainerService.HintSize="296,214" sap2010:WorkflowViewState.IdRef="Sequence_12">
                      <Sequence.Variables>
                        <Variable x:TypeArguments="x:String" Name="processedFile" />
                      </Sequence.Variables>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign DisplayName="Obtener nombre archivo procesado" sap:VirtualizedContainerService.HintSize="258,60" sap2010:WorkflowViewState.IdRef="Assign_46">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[processedFile]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[Path.GetFileName(selectedFile).ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:MoveFile ContinueOnError="{x:Null}" Destination="[dicConfig.Item(&quot;processedFolder&quot;)+processedFile]" DisplayName="Move archivo a procesado" sap:VirtualizedContainerService.HintSize="258,22" sap2010:WorkflowViewState.IdRef="MoveFile_1" Overwrite="True" Path="[selectedFile]" />
                    </Sequence>
                  </If.Then>
                </If>
              </Sequence>
            </ui:CommentOut.Body>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:CommentOut>
        </Sequence>
      </State.Entry>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">70,458.5</av:Point>
          <av:Size x:Key="ShapeSize">200,103</av:Size>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
          <x:Double x:Key="StateContainerWidth">166</x:Double>
          <x:Double x:Key="StateContainerHeight">67</x:Double>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <State.Variables>
        <Variable x:TypeArguments="x:String" Name="variable1" />
      </State.Variables>
    </State>
    <State x:Name="__ReferenceID1" sap2010:Annotation.AnnotationText="Descripción:&#xA;Gestión de Excepciones.&#xA;Excepción de Sistema finaliza flujo con mensaje correspondiente.&#xA;Excepción de Outlook permite un reintento y luego finaliza flujo con mensaje correspondiente.&#xA;&#xA;Procesos:&#xA;n/a&#xA;&#xA;Párametros:&#xA;FlowException System.Exception&#xA;olEx UIPath.Framework.Activities.BusinessRuleExpection&#xA;&#xA;Salidas:&#xA;n/a&#xA;&#xA;Excepciones:&#xA;n/a" DisplayName="System Exception Handler" sap:VirtualizedContainerService.HintSize="196,90" sap2010:WorkflowViewState.IdRef="State_2">
      <State.Entry>
        <Sequence sap:VirtualizedContainerService.HintSize="568,990" sap2010:WorkflowViewState.IdRef="Sequence_41">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Sequence DisplayName="System Exception" sap:VirtualizedContainerService.HintSize="526,898" sap2010:WorkflowViewState.IdRef="Sequence_2">
            <Sequence.Variables>
              <Variable x:TypeArguments="x:Int32" Name="exPopulated" />
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <If Condition="[FlowException isnot Nothing]" sap:VirtualizedContainerService.HintSize="484,700" sap2010:WorkflowViewState.IdRef="If_10">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <If.Then>
                <Sequence sap:VirtualizedContainerService.HintSize="242,552" sap2010:WorkflowViewState.IdRef="Sequence_48">
                  <Sequence.Variables>
                    <Variable x:TypeArguments="sco:Collection(sd:Process)" Name="exProcess" />
                    <Variable x:TypeArguments="ui:Image" Name="image" />
                    <Variable x:TypeArguments="ui:GenericValue" Name="imgFile" />
                    <Variable x:TypeArguments="ui:GenericValue" Name="dtNow" />
                  </Sequence.Variables>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Sequence DisplayName="Log Error" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_169">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:LogMessage sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_2" Level="Error" Message="[&quot;Msg: &quot;+FlowException.Message]" />
                    <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_3" Level="Error" Message="[&quot;Source: &quot;+FlowException.Source]" />
                    <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_64" Level="Error" Message="[&quot;Code: &quot;+FlowException.ToString]" />
                  </Sequence>
                  <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="CommentOut_10">
                    <ui:CommentOut.Body>
                      <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="398,158" sap2010:WorkflowViewState.IdRef="Sequence_167">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <Sequence DisplayName="Toma Captura de Pantalla" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_164">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_55" Level="Info" Message="[&quot;Se toma ScreenShot&quot;]" />
                          <ui:TakeScreenshot WaitBefore="{x:Null}" DisplayName="Take screenshot" sap:VirtualizedContainerService.HintSize="314,68" sap2010:WorkflowViewState.IdRef="TakeScreenshot_1" Screenshot="[image]">
                            <ui:TakeScreenshot.Target>
                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="&lt;wnd app='explorer.exe' cls='Progman' title='Program Manager' /&gt;&lt;wnd cls='SysListView32' title='FolderView' /&gt;" WaitForReady="INTERACTIVE">
                                <ui:Target.TimeoutMS>
                                  <InArgument x:TypeArguments="x:Int32" />
                                </ui:Target.TimeoutMS>
                              </ui:Target>
                            </ui:TakeScreenshot.Target>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:TakeScreenshot>
                          <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_114">
                            <Assign.To>
                              <OutArgument x:TypeArguments="ui:GenericValue">[imgFile]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="ui:GenericValue">[dicConfig.Item("logFolder") + "Error" + date.Now.Year.ToString+date.Now.Month.ToString+date.Now.Day.ToString+"_"+date.Now.Hour.ToString+date.Now.Minute.ToString+date.Now.Second.ToString + ".png"]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <ui:SaveImage DisplayName="Save image" FileName="[imgFile]" sap:VirtualizedContainerService.HintSize="314,92" sap2010:WorkflowViewState.IdRef="SaveImage_1" Image="[image]" />
                          <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_56" Level="Info" Message="[&quot;ScreenShot Guardado como: &quot;+imgFile]" />
                        </Sequence>
                      </Sequence>
                    </ui:CommentOut.Body>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:CommentOut>
                  <Sequence DisplayName="Cierra Aplicaciones" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_165">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_57" Level="Info" Message="[&quot;Analizando Procesos Abriertos &quot;]" />
                    <ui:GetProcesses ContinueOnError="{x:Null}" DisplayName="Get processes" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="GetProcesses_2" Processes="[exProcess]" />
                    <ui:ForEach x:TypeArguments="sd:Process" CurrentIndex="{x:Null}" DisplayName="For each" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="ForEach`1_4" Values="[exProcess]">
                      <ui:ForEach.Body>
                        <ActivityAction x:TypeArguments="sd:Process">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="sd:Process" Name="item" />
                          </ActivityAction.Argument>
                          <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="625,712" sap2010:WorkflowViewState.IdRef="Sequence_53">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <If Condition="[item.ProcessName.ToUpper.Contains(&quot;SAP&quot;)]" sap:VirtualizedContainerService.HintSize="583,620" sap2010:WorkflowViewState.IdRef="If_12">
                              <If.Then>
                                <TryCatch DisplayName="Try catch" sap:VirtualizedContainerService.HintSize="438,472" sap2010:WorkflowViewState.IdRef="TryCatch_19">
                                  <TryCatch.Try>
                                    <Sequence sap:VirtualizedContainerService.HintSize="356,245" sap2010:WorkflowViewState.IdRef="Sequence_163">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:KillProcess ContinueOnError="{x:Null}" ProcessName="{x:Null}" DisplayName="Kill process" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="KillProcess_1" Process="[item]" />
                                      <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_58" Level="Info" Message="[&quot;Ser cerro proceso:  &quot;+item.ProcessName]" />
                                    </Sequence>
                                  </TryCatch.Try>
                                  <TryCatch.Catches>
                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_29">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ActivityAction x:TypeArguments="s:Exception">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                        </ActivityAction.Argument>
                                      </ActivityAction>
                                    </Catch>
                                  </TryCatch.Catches>
                                </TryCatch>
                              </If.Then>
                            </If>
                          </Sequence>
                        </ActivityAction>
                      </ui:ForEach.Body>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:ForEach>
                  </Sequence>
                  <Sequence DisplayName="Mail con Error a Soporte" sap:VirtualizedContainerService.HintSize="376,468" sap2010:WorkflowViewState.IdRef="Sequence_166">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_87">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:String">[strEndMsg]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:String">["&lt;br&gt;&lt;table&gt;"+"&lt;tr&gt;&lt;td&gt; &lt;b&gt;Proceso:&lt;/b&gt;&lt;/td&gt;&lt;td&gt; " + dicRobot.Item("botName")+"&lt;/td&gt;&lt;/tr&gt;"+"&lt;tr&gt;&lt;td&gt; &lt;b&gt;Error:&lt;/b&gt;&lt;/td&gt;&lt;td&gt; " + flowException.Message+"&lt;/td&gt;&lt;/tr&gt;"+"&lt;tr&gt;&lt;td&gt; &lt;b&gt;Origen:&lt;/b&gt;&lt;/td&gt;&lt;td&gt; " + flowException.Source+"&lt;/td&gt;&lt;/tr&gt;"+"&lt;tr&gt;&lt;td&gt; &lt;b&gt;Detalles:&lt;/b&gt;&lt;/td&gt;&lt;td&gt; " + flowException.Tostring+"&lt;/td&gt;&lt;/tr&gt;"+"&lt;/table&gt;"]</InArgument>
                      </Assign.Value>
                    </Assign>
                    <ui:SendExchangeMail Bcc="{x:Null}" Cc="{x:Null}" EmailAutodiscover="{x:Null}" From="{x:Null}" MailMessage="{x:Null}" Name="{x:Null}" TimeoutMS="{x:Null}" Body="[&quot;&lt;h2&gt;Ha ocurrido un error en el proceso &lt;/h2&gt;&lt;hr&gt; &quot;+strEndMsg+&quot;&lt;br&gt;&lt;br&gt;&quot;]" DisplayName="Send Exchange Mail Message" Domain="[dicConfig.item(&quot;outMailDomain&quot;).ToString]" ExchangeVersion="Exchange2013_SP1" sap:VirtualizedContainerService.HintSize="334,145" sap2010:WorkflowViewState.IdRef="SendExchangeMail_1" IsBodyHtml="True" IsDraft="False" Password="[outMailPassword]" SaveCopy="False" Server="[dicConfig.item(&quot;outMailServer&quot;).ToString]" Subject="[&quot;Error en proceso: &quot;+dicRobot.Item(&quot;botName&quot;)+&quot;(Soporte)&quot;]" To="[dicConfig.Item(&quot;MailSoporte&quot;)]" User="[outMailUser]">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:SendExchangeMail>
                    <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_59" Level="Info" Message="[&quot;Se envio Mail de Soporte a:  &quot;+dicConfig.Item(&quot;MailSoporte&quot;)]" />
                  </Sequence>
                  <If Condition="[ambitoError = 1]" DisplayName="If  &lt;el error ocurrio procesando un mail&gt;" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_29">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <If.Then>
                      <Sequence sap:VirtualizedContainerService.HintSize="418,868" sap2010:WorkflowViewState.IdRef="Sequence_180">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <Sequence DisplayName="Mail con Error a Cliente" sap:VirtualizedContainerService.HintSize="376,368" sap2010:WorkflowViewState.IdRef="Sequence_178">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:SendExchangeMail Bcc="{x:Null}" EmailAutodiscover="{x:Null}" MailMessage="{x:Null}" TimeoutMS="{x:Null}" Body="[&quot;&lt;h1&gt; Ha ocurrido un error interno del sistema y ha sido reportado a Soporte &lt;/h1&gt;&lt;br&gt;&lt;p&gt;&lt;hr&gt;&lt;br&gt;&lt;b&gt;De:&lt;/b&gt; &quot;+dicRobot.Item(&quot;strFrom&quot;).ToString+&quot;&lt;br&gt;&lt;b&gt;Para: &lt;/b&gt; &quot;+dicRobot.Item(&quot;strTo&quot;).ToString+&quot;&lt;br&gt;&lt;b&gt;Cc: &lt;/b&gt; &quot;+mailCC+&quot;&lt;br&gt;&lt;b&gt;En Fecha:&lt;/b&gt; &quot;+dicRobot.Item(&quot;strHeaders&quot;).ToString+&quot;&lt;br&gt;&lt;b&gt;Asunto:&lt;/b&gt; &quot;+dicRobot.Item(&quot;strSubject&quot;).ToString+&quot;&lt;br&gt;&lt;br&gt;&quot;+dicRobot.Item(&quot;strBody&quot;).ToString+&quot;&lt;/p&gt;&quot;]" Cc="[mailCC]" DisplayName="Send Exchange Mail Message" Domain="[dicConfig.item(&quot;outMailDomain&quot;).ToString]" ExchangeVersion="Exchange2013_SP1" From="[dicConfig.Item(&quot;outMailAddress&quot;)]" sap:VirtualizedContainerService.HintSize="334,145" sap2010:WorkflowViewState.IdRef="SendExchangeMail_9" IsBodyHtml="True" IsDraft="False" Name="[dicConfig.Item(&quot;MailName&quot;)]" Password="[outMailPassword]" SaveCopy="True" Server="[dicConfig.item(&quot;outMailServer&quot;).ToString]" Subject="[&quot;RE: &quot;+dicRobot.Item(&quot;strSubject&quot;).ToString]" To="[dicConfig.Item(&quot;outMailAddress&quot;).ToString]" User="[outMailUser]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:SendExchangeMail>
                          <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_72" Level="Info" Message="[&quot;Se envio Mail  al Cliente:  &quot;+mailTO]" />
                        </Sequence>
                        <Sequence DisplayName="Mail con Error a Negocio" sap:VirtualizedContainerService.HintSize="376,368" sap2010:WorkflowViewState.IdRef="Sequence_179">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:SendExchangeMail Bcc="{x:Null}" EmailAutodiscover="{x:Null}" MailMessage="{x:Null}" TimeoutMS="{x:Null}" Body="[&quot;&lt;h1&gt; Ha ocurrido un error interno del sistema y ha sido reportado a Soporte &lt;/h1&gt;&lt;br&gt;&lt;p&gt;&lt;hr&gt;&lt;br&gt;&lt;b&gt;De:&lt;/b&gt; &quot;+dicRobot.Item(&quot;strFrom&quot;).ToString+&quot;&lt;br&gt;&lt;b&gt;Para: &lt;/b&gt; &quot;+dicRobot.Item(&quot;strTo&quot;).ToString+&quot;&lt;br&gt;&lt;b&gt;Cc: &lt;/b&gt; &quot;+dicRobot.Item(&quot;mailCC&quot;).ToString+&quot;&lt;br&gt;&lt;b&gt;En Fecha:&lt;/b&gt; &quot;+dicRobot.Item(&quot;strHeaders&quot;).ToString+&quot;&lt;br&gt;&lt;b&gt;Asunto:&lt;/b&gt; &quot;+dicRobot.Item(&quot;strSubject&quot;).ToString+&quot;&lt;br&gt;&lt;br&gt;&quot;+dicRobot.Item(&quot;strBody&quot;).ToString+&quot;&lt;/p&gt;&quot;]" Cc="[mailCC]" DisplayName="Send Exchange Mail Message" Domain="[dicConfig.item(&quot;outMailDomain&quot;).ToString]" ExchangeVersion="Exchange2013_SP1" From="[dicConfig.Item(&quot;outMailAddress&quot;)]" sap:VirtualizedContainerService.HintSize="334,145" sap2010:WorkflowViewState.IdRef="SendExchangeMail_10" IsBodyHtml="True" IsDraft="False" Name="[dicConfig.Item(&quot;MailName&quot;)]" Password="[outMailPassword]" SaveCopy="True" Server="[dicConfig.item(&quot;outMailServer&quot;).ToString]" Subject="[&quot;RE: &quot;+dicRobot.Item(&quot;strSubject&quot;).ToString]" To="[dicCOnfig.Item(&quot;MailNegocio&quot;)]" User="[outMailUser]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:SendExchangeMail>
                          <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_73" Level="Info" Message="[&quot;Se envio Mail  a Negocio:  &quot;+dicConfig.Item(&quot;MailNegocio&quot;)]" />
                        </Sequence>
                      </Sequence>
                    </If.Then>
                  </If>
                </Sequence>
              </If.Then>
            </If>
            <Sequence DisplayName="Eliminar Carpeta Output" sap:VirtualizedContainerService.HintSize="484,66" sap2010:WorkflowViewState.IdRef="Sequence_224">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_99" Level="Info" Message="[&quot;Eliminamos la carpeta output&quot;]" />
              <If Condition="[System.IO.Directory.Exists(dicConfig.Item(&quot;outputFolder&quot;).ToString)]" sap:VirtualizedContainerService.HintSize="484,208" sap2010:WorkflowViewState.IdRef="If_47">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <If.Then>
                  <ui:Delete ContinueOnError="{x:Null}" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delete_6" Path="[dicConfig.Item(&quot;outputFolder&quot;).ToString]" />
                </If.Then>
              </If>
            </Sequence>
          </Sequence>
        </Sequence>
      </State.Entry>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">72,295</av:Point>
          <av:Size x:Key="ShapeSize">196,90</av:Size>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
          <x:Double x:Key="StateContainerWidth">162</x:Double>
          <x:Double x:Key="StateContainerHeight">53.800000000000068</x:Double>
          <x:Boolean x:Key="IsAnnotationDocked">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <State.Transitions>
        <Transition DisplayName="Flow Error Termination" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_2">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:PointCollection x:Key="ConnectorLocation">160.2,385 160.2,415 160,415 160,458.5</av:PointCollection>
              <x:Int32 x:Key="SrcConnectionPointIndex">35</x:Int32>
              <x:Int32 x:Key="DestConnectionPointIndex">34</x:Int32>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Transition.To>
            <x:Reference>__ReferenceID0</x:Reference>
          </Transition.To>
          <Transition.Condition>[strEndMsg &lt;&gt; ""]</Transition.Condition>
        </Transition>
      </State.Transitions>
    </State>
    <State x:Name="__ReferenceID5" sap2010:Annotation.AnnotationText="Descripción:&#xA;Carga configuración inicial&#xA;&#xA;Procesos:&#xA;LoadConfig.xaml&#xA;&#xA;Párametros:&#xA;n/a&#xA;&#xA;Salidas:&#xA;dicConfig Dictionary(of String, String)&#xA;dicRobot Dictionary(of String, String)&#xA;&#xA;&#xA;Excepciones:&#xA;System.Exception" DisplayName="Carga Configuración" sap:VirtualizedContainerService.HintSize="204,80" sap2010:WorkflowViewState.IdRef="State_7">
      <State.Entry>
        <TryCatch sap:VirtualizedContainerService.HintSize="418,1197" sap2010:WorkflowViewState.IdRef="TryCatch_5">
          <TryCatch.Try>
            <Sequence sap:VirtualizedContainerService.HintSize="336,970" sap2010:WorkflowViewState.IdRef="Sequence_8">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Sequence DisplayName="Inicialización" sap:VirtualizedContainerService.HintSize="314,619" sap2010:WorkflowViewState.IdRef="Sequence_14">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_47">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:Boolean">[status]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                  </Assign.Value>
                </Assign>
                <InvokeMethod DisplayName="Start Tiempo Flujo" sap:VirtualizedContainerService.HintSize="242,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_1" MethodName="Start">
                  <InvokeMethod.TargetObject>
                    <InArgument x:TypeArguments="sd:Stopwatch">[swFlujo]</InArgument>
                  </InvokeMethod.TargetObject>
                </InvokeMethod>
                <InvokeMethod DisplayName="Start Tiempo Proceso" sap:VirtualizedContainerService.HintSize="242,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_2" MethodName="Start">
                  <InvokeMethod.TargetObject>
                    <InArgument x:TypeArguments="sd:Stopwatch">[swProceso]</InArgument>
                  </InvokeMethod.TargetObject>
                </InvokeMethod>
                <Sequence DisplayName="Close Applicactions" sap:VirtualizedContainerService.HintSize="242,51" sap2010:WorkflowViewState.IdRef="Sequence_198">
                  <Sequence.Variables>
                    <Variable x:TypeArguments="sco:Collection(sd:Process)" Name="listProcesses" />
                  </Sequence.Variables>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:GetProcesses ContinueOnError="{x:Null}" DisplayName="Get Processes" sap:VirtualizedContainerService.HintSize="480,22" sap2010:WorkflowViewState.IdRef="GetProcesses_4" Processes="[listProcesses]" />
                  <ui:ForEach x:TypeArguments="sd:Process" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="480,342" sap2010:WorkflowViewState.IdRef="ForEach`1_10" Values="[listProcesses]">
                    <ui:ForEach.Body>
                      <ActivityAction x:TypeArguments="sd:Process">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="sd:Process" Name="item" />
                        </ActivityAction.Argument>
                        <If Condition="[item.ProcessName.ToString.Equals(&quot;EXCEL&quot;)]" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_35">
                          <If.Then>
                            <ui:KillProcess ContinueOnError="{x:Null}" ProcessName="{x:Null}" DisplayName="Kill Process" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="KillProcess_3" Process="[item]" />
                          </If.Then>
                        </If>
                      </ActivityAction>
                    </ui:ForEach.Body>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:ForEach>
                </Sequence>
              </Sequence>
              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke LoadConfig workflow" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_5" UnSafe="False" WorkflowFileName="LoadConfig.xaml">
                <ui:InvokeWorkflowFile.Arguments>
                  <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="dicConfig">[dicConfig]</OutArgument>
                  <InOutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="dicRobot">[dicRobot]</InOutArgument>
                </ui:InvokeWorkflowFile.Arguments>
              </ui:InvokeWorkflowFile>
              <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_34">
                <Assign.To>
                  <OutArgument x:TypeArguments="x:Boolean">[Status]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                </Assign.Value>
              </Assign>
            </Sequence>
          </TryCatch.Try>
          <TryCatch.Catches>
            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_5">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ActivityAction x:TypeArguments="s:Exception">
                <ActivityAction.Argument>
                  <DelegateInArgument x:TypeArguments="s:Exception" Name="SysEx" />
                </ActivityAction.Argument>
                <Sequence sap:VirtualizedContainerService.HintSize="264,284" sap2010:WorkflowViewState.IdRef="Sequence_9">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_35">
                    <Assign.To>
                      <OutArgument x:TypeArguments="s:Exception">[FlowException]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="s:Exception">[SysEx]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_36">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:Boolean">[Status]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                    </Assign.Value>
                  </Assign>
                </Sequence>
              </ActivityAction>
            </Catch>
          </TryCatch.Catches>
          <TryCatch.Finally>
            <Sequence DisplayName="Cierre" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Sequence_15">
              <Sequence.Variables>
                <Variable x:TypeArguments="x:String" Default="[environment.NewLine]" Name="nl" />
              </Sequence.Variables>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <InvokeMethod DisplayName="Stop Tiempo Proceso" sap:VirtualizedContainerService.HintSize="314,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_3" MethodName="Stop">
                <InvokeMethod.TargetObject>
                  <InArgument x:TypeArguments="sd:Stopwatch">[swProceso]</InArgument>
                </InvokeMethod.TargetObject>
              </InvokeMethod>
              <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_48">
                <Assign.To>
                  <OutArgument x:TypeArguments="ui:GenericValue">[timeResult]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="ui:GenericValue">["Carga Configuración: " + swProceso.Elapsed.ToString("mm\:ss") + nl]</InArgument>
                </Assign.Value>
              </Assign>
              <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_10" Level="Info" Message="[&quot;Tiempo &quot; + timeResult]" />
            </Sequence>
          </TryCatch.Finally>
        </TryCatch>
      </State.Entry>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">108,10</av:Point>
          <av:Size x:Key="ShapeSize">204,80</av:Size>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
          <x:Double x:Key="StateContainerWidth">170</x:Double>
          <x:Double x:Key="StateContainerHeight">44</x:Double>
          <x:Boolean x:Key="IsAnnotationDocked">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <State.Transitions>
        <Transition DisplayName="Config Success" sap:VirtualizedContainerService.HintSize="430,505" sap2010:WorkflowViewState.IdRef="Transition_10">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Int32 x:Key="SrcConnectionPointIndex">36</x:Int32>
              <x:Int32 x:Key="DestConnectionPointIndex">33</x:Int32>
              <av:PointCollection x:Key="ConnectorLocation">312,50 342,50 342,42.85 418,42.85</av:PointCollection>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Transition.Condition>[Status]</Transition.Condition>
          <Transition.To>
            <State x:Name="__ReferenceID2" sap2010:Annotation.AnnotationText="Descripción:&#xA;Valida existencia de directorios de salida y procesado. &#xA;Valida si Outlook está inicializado.&#xA;&#xA;Procesos:&#xA;n/a&#xA;&#xA;Párametros:&#xA;n/a&#xA;&#xA;Salidas:&#xA;n/a&#xA;&#xA;Excepciones:&#xA;System.Exception (chequea por errores de sistema)&#xA;UIPath.Framework.Activities.BusinessRuleException (chequea por Outlook sin inicializar)" DisplayName="Inicializacion" sap:VirtualizedContainerService.HintSize="207,73" sap2010:WorkflowViewState.IdRef="State_5">
              <State.Entry>
                <TryCatch sap:VirtualizedContainerService.HintSize="438,1007" sap2010:WorkflowViewState.IdRef="TryCatch_4">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <TryCatch.Try>
                    <Sequence sap:VirtualizedContainerService.HintSize="304,758" sap2010:WorkflowViewState.IdRef="Sequence_6">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Sequence DisplayName="Inicialización" sap:VirtualizedContainerService.HintSize="262,66" sap2010:WorkflowViewState.IdRef="Sequence_134">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_161">
                          <Assign.To>
                            <OutArgument x:TypeArguments="x:Boolean">[status]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                          </Assign.Value>
                        </Assign>
                        <InvokeMethod DisplayName="Reset Tiempo Proceso" sap:VirtualizedContainerService.HintSize="242,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_52" MethodName="Reset">
                          <InvokeMethod.TargetObject>
                            <InArgument x:TypeArguments="sd:Stopwatch">[swProceso]</InArgument>
                          </InvokeMethod.TargetObject>
                        </InvokeMethod>
                        <InvokeMethod DisplayName="Reset Tiempo Proceso" sap:VirtualizedContainerService.HintSize="242,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_53" MethodName="Start">
                          <InvokeMethod.TargetObject>
                            <InArgument x:TypeArguments="sd:Stopwatch">[swProceso]</InArgument>
                          </InvokeMethod.TargetObject>
                        </InvokeMethod>
                      </Sequence>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="LogMessage_60" Level="Info" Message="[&quot;Inicializacion: INIT&quot;]">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:LogMessage>
                      <Sequence DisplayName="Cargar Credenciales" sap:VirtualizedContainerService.HintSize="262,66" sap2010:WorkflowViewState.IdRef="Sequence_147">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="x:Boolean" Name="userValid" />
                          <Variable x:TypeArguments="x:String" Name="texto" />
                          <Variable x:TypeArguments="ui:WorkbookApplication" Name="wb1" />
                          <Variable x:TypeArguments="ss:SecureString" Name="clave" />
                          <Variable x:TypeArguments="x:Boolean" Name="encontrada" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="663,91" sap2010:WorkflowViewState.IdRef="LogMessage_43" Level="Info" Message="[&quot;Inicializacion: Cargando Credenciales&quot;]" />
                        <If Condition="[dicConfig.Item(&quot;Credentials_Windows_Or_Orchestrator&quot;).ToString.Equals(&quot;True&quot;)]" sap:VirtualizedContainerService.HintSize="663,691" sap2010:WorkflowViewState.IdRef="If_32">
                          <If.Then>
                            <Sequence DisplayName="Orchestrator" sap:VirtualizedContainerService.HintSize="418,543" sap2010:WorkflowViewState.IdRef="Sequence_196">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Sequence DisplayName="Get EmailCredentials" sap:VirtualizedContainerService.HintSize="376,345" sap2010:WorkflowViewState.IdRef="Sequence_191">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_79" Level="Info" Message="[&quot;Credenciales:  inEmailCredentials =&gt;&quot;+ dicConfig.Item(&quot;inEmailCredentials&quot;).ToString]" />
                                <ui:GetRobotCredential TimeoutMS="{x:Null}" AssetName="[dicConfig.Item(&quot;inEmailCredentials&quot;).ToString]" DisplayName="Get Credential" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="GetRobotCredential_1" Password="[clave]" Username="[inMailUser]" />
                                <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_197">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:String">[inMailPassword]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:String">[new System.Net.NetworkCredential(string.Empty, clave).Password]</InArgument>
                                  </Assign.Value>
                                </Assign>
                              </Sequence>
                              <Sequence DisplayName="Get SAPCredentials" sap:VirtualizedContainerService.HintSize="376,66" sap2010:WorkflowViewState.IdRef="Sequence_195">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_83" Level="Info" Message="[&quot;Credenciales:  SAPCredentials =&gt;&quot;+ dicConfig.Item(&quot;SAPCredentials&quot;).ToString]" />
                                <ui:GetRobotCredential TimeoutMS="{x:Null}" AssetName="[dicConfig.Item(&quot;SAPCredentials&quot;).ToString]" DisplayName="Get Credential" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="GetRobotCredential_2" Password="[clave]" Username="[SAPUser]" />
                                <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_198">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:String">[SAPPassword]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:String">[new System.Net.NetworkCredential(string.Empty, clave).Password]</InArgument>
                                  </Assign.Value>
                                </Assign>
                              </Sequence>
                            </Sequence>
                          </If.Then>
                          <If.Else>
                            <Sequence DisplayName="Windows Credentials" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_190">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Sequence DisplayName="Get InEmailCredentials" sap:VirtualizedContainerService.HintSize="336,368" sap2010:WorkflowViewState.IdRef="Sequence_186">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_75" Level="Info" Message="[&quot;Credenciales:  inEmailCredentials =&gt;&quot;+ dicConfig.Item(&quot;inEmailCredentials&quot;).ToString]" />
                                <ui:GetSecureCredential CredentialType="Generic" DisplayName="Get secure credential inMail" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="GetSecureCredential_4" Password="[clave]" PersistanceType="Enterprise" Result="[encontrada]" Target="[dicConfig.Item(&quot;inEmailCredentials&quot;).ToString]" Username="[inMailUser]" />
                                <If Condition="[encontrada]" DisplayName="Verifica Credenciales inMail" sap:VirtualizedContainerService.HintSize="314,51" sap2010:WorkflowViewState.IdRef="If_30">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If.Then>
                                    <Sequence sap:VirtualizedContainerService.HintSize="336,315" sap2010:WorkflowViewState.IdRef="Sequence_184">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_194">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[inMailPassword]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">[new System.Net.NetworkCredential(string.Empty, clave).Password]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_76" Level="Info" Message="[&quot;Credenciales:  inEmailCredentials =&gt; OK  (&quot;+inMailUser+&quot;) (&quot;+inMailPassword+&quot;)&quot;]" />
                                    </Sequence>
                                  </If.Then>
                                  <If.Else>
                                    <Sequence sap:VirtualizedContainerService.HintSize="222,146" sap2010:WorkflowViewState.IdRef="Sequence_185">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Throw Exception="[new uipath.Core.BusinessRuleException(&quot;Credenciales &quot;+dicConfig.Item(&quot;inEmailCredentials&quot;)+ &quot; No existe en Bobeda de Windows&quot;)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_12" />
                                    </Sequence>
                                  </If.Else>
                                </If>
                              </Sequence>
                              <Sequence DisplayName="Get OutEmailCredentials" sap:VirtualizedContainerService.HintSize="336,51" sap2010:WorkflowViewState.IdRef="Sequence_189">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_77" Level="Info" Message="[&quot;Credenciales:  outEmailCredentials =&gt;&quot;+ dicConfig.Item(&quot;outEmailCredentials&quot;).ToString]" />
                                <ui:GetSecureCredential CredentialType="Generic" DisplayName="Get secure credential outMail" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="GetSecureCredential_5" Password="[clave]" PersistanceType="Enterprise" Result="[encontrada]" Target="[dicConfig.Item(&quot;outEmailCredentials&quot;).ToString]" Username="[outMailUser]" />
                                <If Condition="[encontrada]" DisplayName="Verifica Credenciales outMail" sap:VirtualizedContainerService.HintSize="583,463" sap2010:WorkflowViewState.IdRef="If_31">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If.Then>
                                    <Sequence sap:VirtualizedContainerService.HintSize="336,315" sap2010:WorkflowViewState.IdRef="Sequence_187">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_78" Level="Info" Message="[&quot;Credenciales:  outEmailCredentials =&gt; OK (&quot;+outMailUser+&quot;)&quot;]" />
                                      <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_195">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[outMailPassword]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">[new System.Net.NetworkCredential(string.Empty, clave).Password]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </Sequence>
                                  </If.Then>
                                  <If.Else>
                                    <Sequence sap:VirtualizedContainerService.HintSize="222,146" sap2010:WorkflowViewState.IdRef="Sequence_188">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Throw Exception="[new uipath.Core.BusinessRuleException(&quot;Credenciales &quot;+dicConfig.Item(&quot;outEmailCredentials&quot;)+ &quot; No existe en Bobeda de Windows&quot;)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_13" />
                                    </Sequence>
                                  </If.Else>
                                </If>
                              </Sequence>
                              <Sequence DisplayName="Get SAPCredentials" sap:VirtualizedContainerService.HintSize="336,368" sap2010:WorkflowViewState.IdRef="Sequence_194">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_80" Level="Info" Message="[&quot;Credenciales:  SAPCredentials =&gt;&quot;+ dicConfig.Item(&quot;SAPCredentials&quot;).ToString]" />
                                <ui:GetSecureCredential CredentialType="Generic" DisplayName="Get secure credential SAP" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="GetSecureCredential_6" Password="[clave]" PersistanceType="Enterprise" Target="[dicConfig.Item(&quot;SAPCredentials&quot;).ToString]" Username="[SAPUser]" />
                                <If Condition="[encontrada]" DisplayName="Verifica Credenciales SAP" sap:VirtualizedContainerService.HintSize="464,294" sap2010:WorkflowViewState.IdRef="If_33">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If.Then>
                                    <Sequence sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Sequence_192">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_81" Level="Info" Message="[&quot;Credenciales:  SAPCredentials =&gt; OK (&quot;+SAPUser+&quot;)&quot;]" />
                                      <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_196">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[SAPPassword]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">[new System.Net.NetworkCredential(string.Empty, clave).Password]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </Sequence>
                                  </If.Then>
                                  <If.Else>
                                    <Sequence sap:VirtualizedContainerService.HintSize="222,146" sap2010:WorkflowViewState.IdRef="Sequence_193">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Throw Exception="[new uipath.Core.BusinessRuleException(&quot;Credenciales &quot;+dicConfig.Item(&quot;SAPCredentials&quot;)+ &quot; No existe en Bobeda de Windows&quot;)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_14" />
                                    </Sequence>
                                  </If.Else>
                                </If>
                              </Sequence>
                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="336,91" sap2010:WorkflowViewState.IdRef="LogMessage_82" Level="Info" Message="[&quot;Inicializacion: Credenciales OK&quot;]" />
                            </Sequence>
                          </If.Else>
                        </If>
                      </Sequence>
                      <Sequence DisplayName="checkDir" sap:VirtualizedContainerService.HintSize="262,66" sap2010:WorkflowViewState.IdRef="Sequence_32">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="x:Boolean" Name="boolDir" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:PathExists DisplayName="Path exists" Exists="[boolDir]" sap:VirtualizedContainerService.HintSize="464,89" sap2010:WorkflowViewState.IdRef="PathExists_1" Path="[dicConfig.Item(&quot;inputFolder&quot;)]" PathType="Folder" />
                        <If Condition="[boolDir]" sap:VirtualizedContainerService.HintSize="464,51" sap2010:WorkflowViewState.IdRef="If_2">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <If.Else>
                            <ui:CreateDirectory ContinueOnError="{x:Null}" DisplayName="Create directory" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="CreateDirectory_1" Path="[dicConfig.Item(&quot;inputFolder&quot;)]" />
                          </If.Else>
                        </If>
                        <ui:PathExists DisplayName="Path exists" Exists="[boolDir]" sap:VirtualizedContainerService.HintSize="464,89" sap2010:WorkflowViewState.IdRef="PathExists_2" Path="[dicConfig.Item(&quot;outputFolder&quot;)]" PathType="Folder" />
                        <If Condition="[boolDir]" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_3">
                          <If.Else>
                            <ui:CreateDirectory ContinueOnError="{x:Null}" DisplayName="Create directory" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="CreateDirectory_2" Path="[dicConfig.Item(&quot;outputFolder&quot;)]" />
                          </If.Else>
                        </If>
                        <ui:PathExists DisplayName="Path exists" Exists="[boolDir]" sap:VirtualizedContainerService.HintSize="464,89" sap2010:WorkflowViewState.IdRef="PathExists_3" Path="[dicConfig.Item(&quot;logFolder&quot;)]" PathType="Folder" />
                        <If Condition="[boolDir]" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_4">
                          <If.Else>
                            <ui:CreateDirectory ContinueOnError="{x:Null}" DisplayName="Create directory" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="CreateDirectory_3" Path="[dicConfig.Item(&quot;logFolder&quot;)]" />
                          </If.Else>
                        </If>
                        <ui:PathExists DisplayName="Path exists" Exists="[boolDir]" sap:VirtualizedContainerService.HintSize="464,89" sap2010:WorkflowViewState.IdRef="PathExists_7" Path="[dicConfig.Item(&quot;templateFolder&quot;)]" PathType="Folder" />
                        <If Condition="[boolDir]" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_24">
                          <If.Else>
                            <ui:CreateDirectory ContinueOnError="{x:Null}" DisplayName="Create directory" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="CreateDirectory_4" Path="[dicConfig.Item(&quot;templateFolder&quot;)]" />
                          </If.Else>
                        </If>
                        <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="464,91" sap2010:WorkflowViewState.IdRef="LogMessage_33" Level="Info" Message="[&quot;Folders: OK&quot;]" />
                      </Sequence>
                      <Sequence DisplayName="Cargar Archivos Maestros " sap:VirtualizedContainerService.HintSize="262,66" sap2010:WorkflowViewState.IdRef="Sequence_160">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="x:Boolean" Name="userValid" />
                          <Variable x:TypeArguments="x:String" Name="texto" />
                          <Variable x:TypeArguments="ui:WorkbookApplication" Name="wb1" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_48" Level="Info" Message="[&quot;Inicializacion: Cargando Archivos Maestros&quot;]" />
                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_49" Level="Info" Message="[&quot;Archivos Maestros Creados&quot;]" />
                        <ui:ReadRange AddHeaders="True" DataTable="[dtCentros]" DisplayName="Read Range Centros" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="ReadRange_1" SheetName="Centros" WorkbookPath="[dicConfig(&quot;settingsFolder&quot;)+&quot;\Centros.xlsx&quot;]">
                          <ui:ReadRange.Range>
                            <InArgument x:TypeArguments="x:String">
                              <Literal x:TypeArguments="x:String" Value="" />
                            </InArgument>
                          </ui:ReadRange.Range>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:ReadRange>
                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_50" Level="Info" Message="[&quot;Centros:  Cargado &quot;+dtCentros.Rows.Count.ToString]" />
                        <ui:ReadRange AddHeaders="True" DataTable="[dtItems]" DisplayName="Read Range Items" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ReadRange_2" SheetName="Items" WorkbookPath="[dicConfig(&quot;settingsFolder&quot;)+&quot;\Items.xlsx&quot;]">
                          <ui:ReadRange.Range>
                            <InArgument x:TypeArguments="x:String">
                              <Literal x:TypeArguments="x:String" Value="" />
                            </InArgument>
                          </ui:ReadRange.Range>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:ReadRange>
                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_51" Level="Info" Message="[&quot;Items:  Cargado &quot;+dtItems.rows.Count.ToString]" />
                        <ui:ReadRange AddHeaders="True" DataTable="[dtItemAlternativo]" DisplayName="Read Range ItemAlternativo" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="ReadRange_3" SheetName="ItemAlternativo" WorkbookPath="[dicConfig(&quot;settingsFolder&quot;)+&quot;\ItemAlternativo.xlsx&quot;]">
                          <ui:ReadRange.Range>
                            <InArgument x:TypeArguments="x:String">
                              <Literal x:TypeArguments="x:String" Value="" />
                            </InArgument>
                          </ui:ReadRange.Range>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:ReadRange>
                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_52" Level="Info" Message="[&quot;ItemAlternativo:  Cargado &quot;+dtItemAlternativo.Rows.Count.ToString]" />
                        <ui:ReadRange AddHeaders="True" DataTable="[dtOperatorias]" DisplayName="Read Range Operatorias" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="ReadRange_4" SheetName="Operatorias" WorkbookPath="[dicConfig(&quot;settingsFolder&quot;)+&quot;\Operatorias.xlsx&quot;]">
                          <ui:ReadRange.Range>
                            <InArgument x:TypeArguments="x:String">
                              <Literal x:TypeArguments="x:String" Value="" />
                            </InArgument>
                          </ui:ReadRange.Range>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:ReadRange>
                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_53" Level="Info" Message="[&quot;Operatorias:  Cargado &quot;+dtOperatorias.Rows.Count.ToString]" />
                        <ui:ReadRange AddHeaders="True" DataTable="[dtOperatoriaAlternativa]" DisplayName="Read Range OperatoriaAlternativa" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="ReadRange_5" SheetName="OperatoriaAlternativa" WorkbookPath="[dicConfig(&quot;settingsFolder&quot;)+&quot;\OperatoriaAlternativa.xlsx&quot;]">
                          <ui:ReadRange.Range>
                            <InArgument x:TypeArguments="x:String">
                              <Literal x:TypeArguments="x:String" Value="" />
                            </InArgument>
                          </ui:ReadRange.Range>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:ReadRange>
                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_54" Level="Info" Message="[&quot;OperatoriaAlternativa:  Cargado &quot;+dtOperatoriaAlternativa.Rows.Count.ToString]" />
                        <Sequence DisplayName="Indexar dtOperatoriaAlternativa" sap:VirtualizedContainerService.HintSize="334,66" sap2010:WorkflowViewState.IdRef="Sequence_182">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:AddDataColumn x:TypeArguments="x:String" Column="{x:Null}" DefaultValue="{x:Null}" AllowDBNull="True" AutoIncrement="False" ColumnName="PKEY" DataTable="[dtOperatoriaAlternativa]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_1" MaxLength="100" Unique="False" />
                          <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dtOperatoriaAlternativa]" DisplayName="For Each Row" sap:VirtualizedContainerService.HintSize="314,332" sap2010:WorkflowViewState.IdRef="ForEachRow_2">
                            <ui:ForEachRow.Body>
                              <ActivityAction x:TypeArguments="sd1:DataRow">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="sd1:DataRow" Name="row" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="264,184" sap2010:WorkflowViewState.IdRef="Sequence_181">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_191">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Object">[row.Item("PKEY")]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Object">[row.Item("Operatoria").ToString+row.Item("Operatoria Alternativa").ToString]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </Sequence>
                              </ActivityAction>
                            </ui:ForEachRow.Body>
                          </ui:ForEachRow>
                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_74" Level="Info" Message="[&quot;OperatoriaAlternativa:  Indexado (PKEY) &quot;+dtOperatoriaAlternativa.Rows.Count.ToString]" />
                        </Sequence>
                      </Sequence>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="LogMessage_61" Level="Info" Message="[&quot;Inicializacion: OK&quot;]">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:LogMessage>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_162">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:Boolean">[status]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                  </TryCatch.Try>
                  <TryCatch.Catches>
                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_4">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ActivityAction x:TypeArguments="s:Exception">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                        </ActivityAction.Argument>
                        <Sequence sap:VirtualizedContainerService.HintSize="304,252" sap2010:WorkflowViewState.IdRef="Sequence_7">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_27">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:Boolean">[Status]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                            </Assign.Value>
                          </Assign>
                          <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_28">
                            <Assign.To>
                              <OutArgument x:TypeArguments="s:Exception">[FlowException]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                            </Assign.Value>
                          </Assign>
                        </Sequence>
                      </ActivityAction>
                    </Catch>
                    <Catch x:TypeArguments="ui:BusinessRuleException" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_9">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ActivityAction x:TypeArguments="ui:BusinessRuleException">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="ui:BusinessRuleException" Name="exception" />
                        </ActivityAction.Argument>
                        <Sequence sap:VirtualizedContainerService.HintSize="304,252" sap2010:WorkflowViewState.IdRef="Sequence_45">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_82">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:Boolean">[Status]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                            </Assign.Value>
                          </Assign>
                          <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_163">
                            <Assign.To>
                              <OutArgument x:TypeArguments="s:Exception">[FlowException]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                            </Assign.Value>
                          </Assign>
                        </Sequence>
                      </ActivityAction>
                    </Catch>
                  </TryCatch.Catches>
                  <TryCatch.Finally>
                    <Sequence DisplayName="Cierre" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Sequence_17">
                      <Sequence.Variables>
                        <Variable x:TypeArguments="x:String" Default="[environment.NewLine]" Name="nl" />
                      </Sequence.Variables>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <InvokeMethod DisplayName="Stop Tiempo Proceso" sap:VirtualizedContainerService.HintSize="314,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_6" MethodName="Stop">
                        <InvokeMethod.TargetObject>
                          <InArgument x:TypeArguments="sd:Stopwatch">[swProceso]</InArgument>
                        </InvokeMethod.TargetObject>
                      </InvokeMethod>
                      <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_50">
                        <Assign.To>
                          <OutArgument x:TypeArguments="ui:GenericValue">[timeResult]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="ui:GenericValue">["Inicialización: " + swProceso.Elapsed.ToString("mm\:ss") + nl]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_11" Level="Info" Message="[&quot;Tiempo &quot; + timeResult]" />
                    </Sequence>
                  </TryCatch.Finally>
                </TryCatch>
              </State.Entry>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">418,10</av:Point>
                  <av:Size x:Key="ShapeSize">207,73</av:Size>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <x:Double x:Key="StateContainerWidth">173.00000000000023</x:Double>
                  <x:Double x:Key="StateContainerHeight">36.67999999999995</x:Double>
                  <x:Boolean x:Key="IsAnnotationDocked">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <State.Transitions>
                <Transition DisplayName="Init Success" sap:VirtualizedContainerService.HintSize="430,505" sap2010:WorkflowViewState.IdRef="Transition_6">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:PointCollection x:Key="ConnectorLocation">625,46.5 655,46.5 655,54.2 710.5,54.2</av:PointCollection>
                      <x:Int32 x:Key="SrcConnectionPointIndex">36</x:Int32>
                      <x:Int32 x:Key="DestConnectionPointIndex">41</x:Int32>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Transition.Condition>[status]</Transition.Condition>
                  <Transition.To>
                    <State x:Name="__ReferenceID4" sap2010:Annotation.AnnotationText="Descripcion:&#xA;Es el inicio del proceso, verifica que en el correo electrónico existan correos valido para iniciar el proceso." DisplayName="Listener Mail" sap:VirtualizedContainerService.HintSize="199,84" sap2010:WorkflowViewState.IdRef="State_13">
                      <State.Entry>
                        <TryCatch sap:VirtualizedContainerService.HintSize="877,1640" sap2010:WorkflowViewState.IdRef="TryCatch_20">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <TryCatch.Try>
                            <Sequence sap:VirtualizedContainerService.HintSize="839,1389" sap2010:WorkflowViewState.IdRef="Sequence_137">
                              <Sequence.Variables>
                                <Variable x:TypeArguments="x:Boolean" Name="boolCompleted" />
                              </Sequence.Variables>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Sequence DisplayName="Inicialización" sap:VirtualizedContainerService.HintSize="797,66" sap2010:WorkflowViewState.IdRef="Sequence_136">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_171">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:Boolean">[status]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                  </Assign.Value>
                                </Assign>
                                <InvokeMethod DisplayName="Reset Tiempo Proceso" sap:VirtualizedContainerService.HintSize="242,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_54" MethodName="Reset">
                                  <InvokeMethod.TargetObject>
                                    <InArgument x:TypeArguments="sd:Stopwatch">[swProceso]</InArgument>
                                  </InvokeMethod.TargetObject>
                                </InvokeMethod>
                                <InvokeMethod DisplayName="Reset Tiempo Proceso" sap:VirtualizedContainerService.HintSize="242,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_55" MethodName="Start">
                                  <InvokeMethod.TargetObject>
                                    <InArgument x:TypeArguments="sd:Stopwatch">[swProceso]</InArgument>
                                  </InvokeMethod.TargetObject>
                                </InvokeMethod>
                              </Sequence>
                              <Sequence DisplayName="Check Corrida Previa" sap:VirtualizedContainerService.HintSize="797,941" sap2010:WorkflowViewState.IdRef="Sequence_199">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="755,91" sap2010:WorkflowViewState.IdRef="LogMessage_84" Level="Info" Message="[&quot;Verificamos existencia de corrida previa.&quot;]" />
                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="755,91" sap2010:WorkflowViewState.IdRef="LogMessage_87" Level="Info" Message="[dicConfig.Item(&quot;outputFolder&quot;).ToString+dicConfig.Item(&quot;nameCorridaPrevia&quot;).ToString+&quot;.xlsx&quot;]" />
                                <ui:PathExists DisplayName="Path Exists" Exists="[boolCorridaPreviaExist]" sap:VirtualizedContainerService.HintSize="755,89" sap2010:WorkflowViewState.IdRef="PathExists_8" Path="[dicConfig.Item(&quot;outputFolder&quot;).ToString+dicConfig.Item(&quot;nameCorridaPrevia&quot;).ToString+&quot;.xlsx&quot;]" PathType="File" />
                                <If Condition="[boolCorridaPreviaExist]" sap:VirtualizedContainerService.HintSize="755,458" sap2010:WorkflowViewState.IdRef="If_37">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If.Then>
                                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_85" Level="Info" Message="[&quot;SI existe la corrida previa ---&gt; &quot;+dicConfig.Item(&quot;outputFolder&quot;).ToString+dicConfig.Item(&quot;nameCorridaPrevia&quot;).ToString+&quot;.xlsx&quot;]" />
                                  </If.Then>
                                  <If.Else>
                                    <Sequence sap:VirtualizedContainerService.HintSize="376,310" sap2010:WorkflowViewState.IdRef="Sequence_200">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_86" Level="Info" Message="[&quot;NO existe una corrida previa, chequeamos la casilla de correo.&quot;]" />
                                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke getCredentials workflow" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_25" UnSafe="False" WorkflowFileName="CheckCorreo.xaml">
                                        <ui:InvokeWorkflowFile.Arguments>
                                          <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="dicConfig">[dicConfig]</InArgument>
                                          <InOutArgument x:TypeArguments="scg:List(snm:MailMessage)" x:Key="lstCorreos">[listaCorreos]</InOutArgument>
                                          <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="dicRobot">[dicRobot]</InArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="inMailPassword">[inMailPassword]</InArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="inMailUser">[inMailUser]</InArgument>
                                          <OutArgument x:TypeArguments="x:Boolean" x:Key="boolCompleted">[boolCompleted]</OutArgument>
                                        </ui:InvokeWorkflowFile.Arguments>
                                      </ui:InvokeWorkflowFile>
                                    </Sequence>
                                  </If.Else>
                                </If>
                              </Sequence>
                              <If Condition="[boolCompleted Or boolCorridaPreviaExist]" sap:VirtualizedContainerService.HintSize="797,210" sap2010:WorkflowViewState.IdRef="If_39">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_202">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Boolean">[Status]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </If.Then>
                                <If.Else>
                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_203">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Boolean">[Status]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </If.Else>
                              </If>
                            </Sequence>
                          </TryCatch.Try>
                          <TryCatch.Catches>
                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,22" sap2010:WorkflowViewState.IdRef="Catch`1_30">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ActivityAction x:TypeArguments="s:Exception">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                </ActivityAction.Argument>
                                <Sequence sap:VirtualizedContainerService.HintSize="304,248" sap2010:WorkflowViewState.IdRef="Sequence_138">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_173">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Boolean">[status]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_174">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="s:Exception">[FlowException]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </Sequence>
                              </ActivityAction>
                            </Catch>
                            <Catch x:TypeArguments="ui:BusinessRuleException" sap:VirtualizedContainerService.HintSize="404,22" sap2010:WorkflowViewState.IdRef="Catch`1_31">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ActivityAction x:TypeArguments="ui:BusinessRuleException">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="ui:BusinessRuleException" Name="exception" />
                                </ActivityAction.Argument>
                                <Sequence sap:VirtualizedContainerService.HintSize="304,248" sap2010:WorkflowViewState.IdRef="Sequence_139">
                                  <Sequence.Variables>
                                    <Variable x:TypeArguments="s:Exception" Name="OutEx" />
                                  </Sequence.Variables>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_175">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="s:Exception">[FlowException]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_176">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Boolean">[Status]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </Sequence>
                              </ActivityAction>
                            </Catch>
                          </TryCatch.Catches>
                          <TryCatch.Finally>
                            <Sequence DisplayName="Cierre" sap:VirtualizedContainerService.HintSize="376,459" sap2010:WorkflowViewState.IdRef="Sequence_140">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <InvokeMethod DisplayName="Stop Tiempo Proceso" sap:VirtualizedContainerService.HintSize="334,134" sap2010:WorkflowViewState.IdRef="InvokeMethod_56" MethodName="Stop">
                                <InvokeMethod.TargetObject>
                                  <InArgument x:TypeArguments="sd:Stopwatch">[swProceso]</InArgument>
                                </InvokeMethod.TargetObject>
                              </InvokeMethod>
                              <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_177">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="ui:GenericValue">[timeResult]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="ui:GenericValue">["Check Correo : " + swProceso.Elapsed.ToString("mm\:ss") + newLine]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="334,93" sap2010:WorkflowViewState.IdRef="LogMessage_42" Level="Info" Message="[&quot;Tiempo &quot; + timeResult]" />
                            </Sequence>
                          </TryCatch.Finally>
                        </TryCatch>
                      </State.Entry>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <av:Point x:Key="ShapeLocation">710.5,8</av:Point>
                          <av:Size x:Key="ShapeSize">199,84</av:Size>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          <x:Double x:Key="StateContainerWidth">165</x:Double>
                          <x:Double x:Key="StateContainerHeight">47.800000000000068</x:Double>
                          <x:Boolean x:Key="IsAnnotationDocked">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <State.Transitions>
                        <Transition DisplayName="Hay Correo" sap:VirtualizedContainerService.HintSize="450,514" sap2010:WorkflowViewState.IdRef="Transition_32">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:PointCollection x:Key="ConnectorLocation">810,92 810,228</av:PointCollection>
                              <x:Int32 x:Key="SrcConnectionPointIndex">39</x:Int32>
                              <x:Int32 x:Key="DestConnectionPointIndex">38</x:Int32>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Transition.Condition>[(listaCorreos isnot nothing OR boolCorridaPreviaExist) AND status]</Transition.Condition>
                          <Transition.To>
                            <State x:Name="__ReferenceID3" sap2010:Annotation.AnnotationText="Descripcion:&#xA;Procesa cada uno de los correos. Los trabaja individualmente obtiene datos del correo," DisplayName="ProcessMail" sap:VirtualizedContainerService.HintSize="502,1784" sap2010:WorkflowViewState.IdRef="State_12">
                              <State.Entry>
                                <TryCatch sap:VirtualizedContainerService.HintSize="456,1397" sap2010:WorkflowViewState.IdRef="TryCatch_12">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <TryCatch.Try>
                                    <Sequence sap:VirtualizedContainerService.HintSize="418,1148" sap2010:WorkflowViewState.IdRef="Sequence_144">
                                      <Sequence.Variables>
                                        <Variable x:TypeArguments="snm:MailMessage" Name="correoPedido" />
                                        <Variable x:TypeArguments="sd1:DataTable" Name="dtCorridaPreviaMails" />
                                      </Sequence.Variables>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Sequence DisplayName="Inicialización" sap:VirtualizedContainerService.HintSize="376,66" sap2010:WorkflowViewState.IdRef="Sequence_149">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_178">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:Boolean">[status]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <InvokeMethod DisplayName="Start Tiempo Flujo" sap:VirtualizedContainerService.HintSize="242,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_57" MethodName="Start">
                                          <InvokeMethod.TargetObject>
                                            <InArgument x:TypeArguments="sd:Stopwatch">[swFlujo]</InArgument>
                                          </InvokeMethod.TargetObject>
                                        </InvokeMethod>
                                        <InvokeMethod DisplayName="Start Tiempo Proceso" sap:VirtualizedContainerService.HintSize="242,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_58" MethodName="Start">
                                          <InvokeMethod.TargetObject>
                                            <InArgument x:TypeArguments="sd:Stopwatch">[swProceso]</InArgument>
                                          </InvokeMethod.TargetObject>
                                        </InvokeMethod>
                                      </Sequence>
                                      <Assign sap:VirtualizedContainerService.HintSize="376,60" sap2010:WorkflowViewState.IdRef="Assign_188">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Int32">[ambitoError]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Int32">1</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <Sequence DisplayName="If CorridaPrevia Or CheckMail" sap:VirtualizedContainerService.HintSize="376,650" sap2010:WorkflowViewState.IdRef="Sequence_204">
                                        <Sequence.Variables>
                                          <Variable x:TypeArguments="x:Boolean" Name="boolAccessWeb" />
                                        </Sequence.Variables>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If Condition="[boolCorridaPreviaExist]" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="If_40">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <Sequence DisplayName="Get Corrida Previa in DT" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_220">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_95" Level="Info" Message="[&quot;Arrancamos el proceso a partir de la corrida previa&quot;]">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:LogMessage>
                                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_96" Level="Info" Message="[&quot;Obtenemos el DT de Mails&quot;]" />
                                              <ui:ReadRange AddHeaders="True" DataTable="[dtCorridaPreviaMails]" DisplayName="Read Range Mails" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ReadRange_8" SheetName="[dicConfig.Item(&quot;nameSheetMails&quot;).ToString]" WorkbookPath="[dicConfig.Item(&quot;outputFolder&quot;).ToString+dicConfig.Item(&quot;nameCorridaPrevia&quot;)+&quot;.xlsx&quot;]">
                                                <ui:ReadRange.Range>
                                                  <InArgument x:TypeArguments="x:String">
                                                    <Literal x:TypeArguments="x:String" Value="" />
                                                  </InArgument>
                                                </ui:ReadRange.Range>
                                              </ui:ReadRange>
                                              <ui:ForEachRow CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Asignamos a las variables del diccionario los valores que necesitaremos para el flujo." DataTable="[dtCorridaPreviaMails]" DisplayName="For Each Row" sap:VirtualizedContainerService.HintSize="334,108" sap2010:WorkflowViewState.IdRef="ForEachRow_4">
                                                <ui:ForEachRow.Body>
                                                  <ActivityAction x:TypeArguments="sd1:DataRow">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="sd1:DataRow" Name="row" />
                                                    </ActivityAction.Argument>
                                                    <Sequence DisplayName="Asignar valores obtenidos del correo" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_219">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_223">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[mailCC]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">[row.Item("MailCC").ToString]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_224">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[mailTO]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">[row.Item("MailTo").ToString]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_225">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[dicRobot.Item("strFrom")]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">[row.Item("From").ToString]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_226">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[dicRobot.Item("strTo")]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">[row.Item("To").ToString]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_227">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[dicRobot.Item("strHeaders")]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">[row.Item("Headers").ToString]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_228">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[dicRobot.Item("strSubject")]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">[row.Item("Subject").ToString]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_229">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[dicRobot.Item("strBody")]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">[row.Item("Body").ToString]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                    </Sequence>
                                                  </ActivityAction>
                                                </ui:ForEachRow.Body>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:ForEachRow>
                                            </Sequence>
                                          </If.Then>
                                          <If.Else>
                                            <Sequence sap:VirtualizedContainerService.HintSize="424,1679" sap2010:WorkflowViewState.IdRef="Sequence_217">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:ForEach x:TypeArguments="snm:MailMessage" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Recorremos el mail obtenido y asignamos en variables todos los datos que usaremos" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="382,1409" sap2010:WorkflowViewState.IdRef="ForEach`1_7" Values="[listaCorreos]">
                                                <ui:ForEach.Body>
                                                  <ActivityAction x:TypeArguments="snm:MailMessage">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="snm:MailMessage" Name="itemcorreo" />
                                                    </ActivityAction.Argument>
                                                    <Sequence sap:VirtualizedContainerService.HintSize="346,1233" sap2010:WorkflowViewState.IdRef="Sequence_145">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="304,60" sap2010:WorkflowViewState.IdRef="Assign_190">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="snm:MailMessage">[correoPedido]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="snm:MailMessage">[itemcorreo]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Sequence DisplayName="Asignar valores obtenidos del correo" sap:VirtualizedContainerService.HintSize="304,552" sap2010:WorkflowViewState.IdRef="Sequence_216">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_211">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:String">[dicRobot.Item("strFrom")]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:String">[correoPedido.From.ToString]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                        <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_212">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:String">[dicRobot.Item("strTo")]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:String">[correoPedido.To.ToString]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                        <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_213">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:String">[dicRobot.Item("strHeaders")]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:String">[correoPedido.Headers("DateReceived").ToString]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                        <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_214">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:String">[dicRobot.Item("strSubject")]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:String">[correoPedido.Subject]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                        <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_215">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:String">[dicRobot.Item("strBody")]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:String">[correoPedido.Body.ToString]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                      </Sequence>
                                                      <Sequence DisplayName="Determinar mail.CC" sap:VirtualizedContainerService.HintSize="304,66" sap2010:WorkflowViewState.IdRef="Sequence_171">
                                                        <Sequence.Variables>
                                                          <Variable x:TypeArguments="sd1:DataTable" Name="dtCorridaPreviaMails" />
                                                        </Sequence.Variables>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:BuildDataTable DataTable="[dtCorridaPreviaMails]" DisplayName="Build Data Table" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="BuildDataTable_1" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;Correos&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;100&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;" />
                                                        <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_180">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:String">[mailCC]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:String">[string.Empty]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                        <ui:ForEach x:TypeArguments="snm:MailAddress" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="ForEach`1_8" Values="[itemcorreo.CC]">
                                                          <ui:ForEach.Body>
                                                            <ActivityAction x:TypeArguments="snm:MailAddress">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="snm:MailAddress" Name="addr" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="304,152" sap2010:WorkflowViewState.IdRef="Sequence_170">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_181">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[mailCC]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">[mailCC+addr.Address+";"]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:ForEach.Body>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:ForEach>
                                                        <If Condition="[mailCC.Length &gt; 0]" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="If_25">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Then>
                                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_182">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[mailCC]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">[mailCC.Substring(0,mailCC.Length-1)]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </If.Then>
                                                        </If>
                                                        <Assign sap2010:Annotation.AnnotationText="Lo guardamos en el diccionario." sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="Assign_230">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:String">[dicRobot.Item("strMailCC")]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:String">[mailCC]</InArgument>
                                                          </Assign.Value>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </Assign>
                                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_67" Level="Info" Message="[&quot; CC: &quot;+mailCC]" />
                                                      </Sequence>
                                                      <Sequence DisplayName="Determinar mail.TO" sap:VirtualizedContainerService.HintSize="304,252" sap2010:WorkflowViewState.IdRef="Sequence_227">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_183">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:String">[mailTO]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:String">[correoPedido.From.Address.Trim]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                        <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_231">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:String">[dicRobot.Item("strMailTO")]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:String">[mailTO.ToString]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                      </Sequence>
                                                      <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="304,51" sap2010:WorkflowViewState.IdRef="CommentOut_12">
                                                        <ui:CommentOut.Body>
                                                          <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="242,158" sap2010:WorkflowViewState.IdRef="Sequence_212">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Sequence DisplayName="Escribir en CorridaPrevia los mails" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_206">
                                                              <Sequence.Variables>
                                                                <Variable x:TypeArguments="ui:WorkbookApplication" Name="wb" />
                                                              </Sequence.Variables>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="475,514" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_1" Visible="False" Workbook="[wb]" WorkbookPath="[dicConfig.Item(&quot;outputFolder&quot;)+dicConfig.Item(&quot;nameCorridaPrevia&quot;)+&quot;.xlsx&quot;]">
                                                                <ui:ExcelApplicationScope.Body>
                                                                  <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                                    <ActivityAction.Argument>
                                                                      <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                                    </ActivityAction.Argument>
                                                                    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,405" sap2010:WorkflowViewState.IdRef="Sequence_205">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <ui:ExcelWriteCell Cell="A2" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_1" SheetName="Mails" Text="[mailCC.ToString]" />
                                                                      <ui:ExcelWriteCell Cell="A3" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_2" SheetName="Mails" Text="[mailTO.ToString]" />
                                                                      <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_1" Workbook="[wb]" />
                                                                    </Sequence>
                                                                  </ActivityAction>
                                                                </ui:ExcelApplicationScope.Body>
                                                              </ui:ExcelApplicationScope>
                                                            </Sequence>
                                                          </Sequence>
                                                        </ui:CommentOut.Body>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:CommentOut>
                                                    </Sequence>
                                                  </ActivityAction>
                                                </ui:ForEach.Body>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:ForEach>
                                              <Sequence sap2010:Annotation.AnnotationText="Creamos el excel de la corrida previa pasandole los valores obtenidos en la solapa de mails" DisplayName="Create Excel CorridaPrevia.xlsx" sap:VirtualizedContainerService.HintSize="382,138" sap2010:WorkflowViewState.IdRef="Sequence_215">
                                                <Sequence.Variables>
                                                  <Variable x:TypeArguments="x:Boolean" Name="boolTemplateCorridaPrevia" />
                                                </Sequence.Variables>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_92" Level="Info" Message="[&quot;Creamos corrida previa a partir del template&quot;]" />
                                                <ui:PathExists DisplayName="Path Exists" Exists="[boolTemplateCorridaPrevia]" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="PathExists_9" Path="[dicConfig.Item(&quot;templateFolder&quot;).ToString+dicConfig.Item(&quot;nameCorridaPrevia&quot;)+&quot;.xlsx&quot;]" PathType="File">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:PathExists>
                                                <If Condition="[boolTemplateCorridaPrevia]" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="If_43">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Sequence sap:VirtualizedContainerService.HintSize="376,245" sap2010:WorkflowViewState.IdRef="Sequence_213">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_93" Level="Info" Message="[&quot;Copiamos el Template&quot;]" />
                                                      <ui:CopyFile ContinueOnError="{x:Null}" Destination="[dicConfig.Item(&quot;outputFolder&quot;).ToString+dicConfig.Item(&quot;nameCorridaPrevia&quot;)+&quot;.xlsx&quot;]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="CopyFile_1" Overwrite="False" Path="[dicConfig.Item(&quot;templateFolder&quot;).ToString+dicConfig.Item(&quot;nameCorridaPrevia&quot;)+&quot;.xlsx&quot;]" />
                                                    </Sequence>
                                                  </If.Then>
                                                  <If.Else>
                                                    <Sequence sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_214">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_94" Level="Info" Message="[&quot;No se encuentra el Template&quot;]" />
                                                      <Throw Exception="[new BusinessRuleException(dicConfig.Item(&quot;nameExceptionNotFoundTemplate&quot;).ToString)]" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Throw_15" />
                                                    </Sequence>
                                                  </If.Else>
                                                </If>
                                                <ui:ReadRange AddHeaders="True" DataTable="[dtCorridaPreviaMails]" DisplayName="Read Range Solapa Mails" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ReadRange_7" SheetName="[dicConfig.Item(&quot;nameSheetMails&quot;).ToString]" WorkbookPath="[dicConfig.Item(&quot;outputFolder&quot;).ToString+dicConfig.Item(&quot;nameCorridaPrevia&quot;)+&quot;.xlsx&quot;]">
                                                  <ui:ReadRange.Range>
                                                    <InArgument x:TypeArguments="x:String">
                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                    </InArgument>
                                                  </ui:ReadRange.Range>
                                                </ui:ReadRange>
                                                <ui:AddDataRow DataRow="{x:Null}" sap2010:Annotation.AnnotationText="Agregamos la fila con todos los valores obtenidos del mail" ArrayRow="[{mailCC,mailTO,dicRobot.Item(&quot;strFrom&quot;).ToString,dicRobot.Item(&quot;strTo&quot;).ToString,dicRobot.Item(&quot;strHeaders&quot;).ToString,dicRobot.Item(&quot;strSubject&quot;).ToString,dicRobot.Item(&quot;strBody&quot;).ToString}]" DataTable="[dtCorridaPreviaMails]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="334,64" sap2010:WorkflowViewState.IdRef="AddDataRow_2">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:AddDataRow>
                                                <ui:WriteRange AddHeaders="True" DataTable="[dtCorridaPreviaMails]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334,115" sap2010:WorkflowViewState.IdRef="WriteRange_2" SheetName="[dicConfig.Item(&quot;nameSheetMails&quot;).ToString]" StartingCell="A1" WorkbookPath="[dicConfig.Item(&quot;outputFolder&quot;).ToString+dicConfig.Item(&quot;nameCorridaPrevia&quot;)+&quot;.xlsx&quot;]" />
                                              </Sequence>
                                            </Sequence>
                                          </If.Else>
                                        </If>
                                        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke ProccesMail workflow" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_27" UnSafe="False" WorkflowFileName="ProccesMail.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="dicConfig">[dicConfig]</InArgument>
                                            <InArgument x:TypeArguments="sd1:DataTable" x:Key="dtOperatoriaAlternativa">[dtOperatoriaAlternativa]</InArgument>
                                            <InArgument x:TypeArguments="sd1:DataTable" x:Key="dtCentros">[dtCentros]</InArgument>
                                            <InArgument x:TypeArguments="sd1:DataTable" x:Key="dtItems">[dtItems]</InArgument>
                                            <InArgument x:TypeArguments="sd1:DataTable" x:Key="dtOperatorias">[dtOperatorias]</InArgument>
                                            <InArgument x:TypeArguments="sd1:DataTable" x:Key="dtItemAlternativo">[dtItemAlternativo]</InArgument>
                                            <InOutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="dicRobot">[dicRobot]</InOutArgument>
                                            <InOutArgument x:TypeArguments="x:String" x:Key="estatusProcPedido">[estatusProcPedido]</InOutArgument>
                                            <InOutArgument x:TypeArguments="x:String" x:Key="mensajeProcPedido">[mensajeProcPedido]</InOutArgument>
                                            <InOutArgument x:TypeArguments="x:String" x:Key="tempoFolder">[tempoFolder]</InOutArgument>
                                            <InOutArgument x:TypeArguments="x:String" x:Key="filePedido">[filePedido]</InOutArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="outMailPassword">[outMailPassword]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="outMailUser">[outMailUser]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="SAPUser">[SAPUser]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="SAPPassword">[SAPPassword]</InArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="msjPedidoFallido">[msjPedidoFallido]</OutArgument>
                                            <InArgument x:TypeArguments="x:Boolean" x:Key="boolCorridaPreviaExist">[boolCorridaPreviaExist]</InArgument>
                                            <InArgument x:TypeArguments="snm:MailMessage" x:Key="correo">[correoPedido]</InArgument>
                                            <OutArgument x:TypeArguments="x:Boolean" x:Key="boolAccessWeb">[boolAccessWeb]</OutArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                        </ui:InvokeWorkflowFile>
                                        <Sequence DisplayName="Informar Resultado Cliente" sap:VirtualizedContainerService.HintSize="334,340" sap2010:WorkflowViewState.IdRef="Sequence_210">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If Condition="[boolAccessWeb]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_48">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <Sequence sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_225">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_100" Level="Info" Message="[&quot;Se pudo realizar el proceso exitosamente&quot;]" />
                                                <ui:SendExchangeMail Bcc="{x:Null}" EmailAutodiscover="{x:Null}" From="{x:Null}" MailMessage="{x:Null}" Name="{x:Null}" TimeoutMS="{x:Null}" Body="[mensajeProcPedido+&quot;&lt;br&gt;&quot;+msjPedidoFallido+strMsjError+&quot;&lt;br&gt;&lt;p&gt;&lt;hr&gt;&lt;br&gt;&lt;b&gt;De:&lt;/b&gt; &quot;+dicRobot.Item(&quot;strFrom&quot;).ToString+&quot;&lt;br&gt;&lt;b&gt;Para: &lt;/b&gt; &quot;+dicRobot.Item(&quot;strTo&quot;).ToString+&quot;&lt;br&gt;&lt;b&gt;Cc: &lt;/b&gt; &quot;+mailCC+&quot;&lt;br&gt;&lt;b&gt;En Fecha:&lt;/b&gt; &quot;+dicRobot.Item(&quot;strHeaders&quot;).ToString+&quot;&lt;br&gt;&lt;b&gt;Asunto:&lt;/b&gt; &quot;+dicRobot.Item(&quot;strSubject&quot;).ToString+&quot;&lt;br&gt;&lt;br&gt;&quot;+dicRobot.Item(&quot;strBody&quot;).ToString+&quot;&lt;/p&gt;&quot;]" Cc="[mailCC]" DisplayName="Send Exchange Mail Message" Domain="[dicConfig.item(&quot;outMailDomain&quot;).ToString]" ExchangeVersion="Exchange2013_SP1" sap:VirtualizedContainerService.HintSize="334,145" sap2010:WorkflowViewState.IdRef="SendExchangeMail_11" IsBodyHtml="True" IsDraft="False" Password="[outMailPassword]" SaveCopy="True" Server="[dicConfig.item(&quot;outMailServer&quot;).ToString]" Subject="[&quot;RE: &quot;+dicRobot.Item(&quot;strSubject&quot;).ToString]" To="[mailTO+&quot;;&quot;+dicConfig.Item(&quot;outMailAddress&quot;).ToString]" User="[outMailUser]">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:SendExchangeMail>
                                              </Sequence>
                                            </If.Then>
                                            <If.Else>
                                              <Sequence sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_226">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_101" Level="Info" Message="[&quot;No se tuvo acceso a la WEB&quot;]" />
                                                <ui:SendExchangeMail Bcc="{x:Null}" EmailAutodiscover="{x:Null}" From="{x:Null}" MailMessage="{x:Null}" Name="{x:Null}" TimeoutMS="{x:Null}" Body="[dicConfig.Item(&quot;msjSinAccesoWeb&quot;).ToString]" Cc="[mailCC]" DisplayName="Send Exchange Mail Message" Domain="[dicConfig.item(&quot;outMailDomain&quot;).ToString]" ExchangeVersion="Exchange2013_SP1" sap:VirtualizedContainerService.HintSize="334,145" sap2010:WorkflowViewState.IdRef="SendExchangeMail_12" IsBodyHtml="True" IsDraft="False" Password="[outMailPassword]" SaveCopy="True" Server="[dicConfig.item(&quot;outMailServer&quot;).ToString]" Subject="[&quot;RE: &quot;+dicRobot.Item(&quot;strSubject&quot;).ToString]" To="[mailTO+&quot;;&quot;+dicConfig.Item(&quot;outMailAddress&quot;).ToString]" User="[outMailUser]">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:SendExchangeMail>
                                              </Sequence>
                                            </If.Else>
                                          </If>
                                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="LogMessage_91" Level="Info" Message="[&quot;Mail de Respuesta enviado a: &quot;+mailTO+ &quot; Cc: &quot;+mailCC]">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:LogMessage>
                                          <Sequence DisplayName="Clean Variables" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_211">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_209">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[mensajeProcPedido]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">
                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                </InArgument>
                                              </Assign.Value>
                                            </Assign>
                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_210">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[msjPedidoFallido]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">
                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                </InArgument>
                                              </Assign.Value>
                                            </Assign>
                                          </Sequence>
                                        </Sequence>
                                      </Sequence>
                                      <Assign sap:VirtualizedContainerService.HintSize="376,60" sap2010:WorkflowViewState.IdRef="Assign_179">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Boolean">[status]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <Assign sap:VirtualizedContainerService.HintSize="376,60" sap2010:WorkflowViewState.IdRef="Assign_189">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Int32">[ambitoError]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </Sequence>
                                  </TryCatch.Try>
                                  <TryCatch.Catches>
                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="422,21" sap2010:WorkflowViewState.IdRef="Catch`1_18">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ActivityAction x:TypeArguments="s:Exception">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                        </ActivityAction.Argument>
                                        <Sequence sap:VirtualizedContainerService.HintSize="304,252" sap2010:WorkflowViewState.IdRef="Sequence_82">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_117">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:Boolean">[status]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_118">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="s:Exception">[FlowException]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                        </Sequence>
                                      </ActivityAction>
                                    </Catch>
                                    <Catch x:TypeArguments="ui:BusinessRuleException" sap:VirtualizedContainerService.HintSize="422,21" sap2010:WorkflowViewState.IdRef="Catch`1_19">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ActivityAction x:TypeArguments="ui:BusinessRuleException">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="ui:BusinessRuleException" Name="exception" />
                                        </ActivityAction.Argument>
                                        <Sequence sap:VirtualizedContainerService.HintSize="304,252" sap2010:WorkflowViewState.IdRef="Sequence_83">
                                          <Sequence.Variables>
                                            <Variable x:TypeArguments="s:Exception" Name="OutEx" />
                                          </Sequence.Variables>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_119">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="s:Exception">[FlowException]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_120">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:Boolean">[Status]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                        </Sequence>
                                      </ActivityAction>
                                    </Catch>
                                  </TryCatch.Catches>
                                  <TryCatch.Finally>
                                    <Sequence DisplayName="Cierre" sap:VirtualizedContainerService.HintSize="336,487" sap2010:WorkflowViewState.IdRef="Sequence_84">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <InvokeMethod DisplayName="Stop Tiempo Proceso" sap:VirtualizedContainerService.HintSize="314,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_32" MethodName="Stop">
                                        <InvokeMethod.TargetObject>
                                          <InArgument x:TypeArguments="sd:Stopwatch">[swProceso]</InArgument>
                                        </InvokeMethod.TargetObject>
                                      </InvokeMethod>
                                      <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_121">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="ui:GenericValue">[timeResult]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="ui:GenericValue">["Proccess Mail : " + swProceso.Elapsed.ToString("mm\:ss") + newLine]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_24" Level="Info" Message="[&quot;Tiempo &quot; + timeResult]" />
                                    </Sequence>
                                  </TryCatch.Finally>
                                </TryCatch>
                              </State.Entry>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <av:Point x:Key="ShapeLocation">710.5,228</av:Point>
                                  <av:Size x:Key="ShapeSize">199,84</av:Size>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  <x:Double x:Key="StateContainerWidth">165</x:Double>
                                  <x:Double x:Key="StateContainerHeight">47.800000000000068</x:Double>
                                  <x:Boolean x:Key="IsAnnotationDocked">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <State.Transitions>
                                <Transition DisplayName="ProccesMailException" sap2010:WorkflowViewState.IdRef="Transition_31">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:PointCollection x:Key="ConnectorLocation">710.5,265.8 179.8,265.8 179.8,295</av:PointCollection>
                                      <x:Int32 x:Key="SrcConnectionPointIndex">33</x:Int32>
                                      <x:Int32 x:Key="DestConnectionPointIndex">42</x:Int32>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Transition.To>
                                    <x:Reference>__ReferenceID1</x:Reference>
                                  </Transition.To>
                                  <Transition.Condition>[FlowException isNot Nothing]</Transition.Condition>
                                </Transition>
                                <Transition DisplayName="Finalizar Flujo" sap2010:WorkflowViewState.IdRef="Transition_34">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:PointCollection x:Key="ConnectorLocation">810,312 810,515.15 270,515.15</av:PointCollection>
                                      <x:Int32 x:Key="SrcConnectionPointIndex">39</x:Int32>
                                      <x:Int32 x:Key="DestConnectionPointIndex">40</x:Int32>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Transition.To>
                                    <x:Reference>__ReferenceID0</x:Reference>
                                  </Transition.To>
                                  <Transition.Condition>[status]</Transition.Condition>
                                </Transition>
                              </State.Transitions>
                              <State.Variables>
                                <Variable x:TypeArguments="x:String" Name="msjPedidoFallido" />
                                <Variable x:TypeArguments="x:String" Name="strBody" />
                                <Variable x:TypeArguments="x:String" Name="strMsjError" />
                              </State.Variables>
                            </State>
                          </Transition.To>
                        </Transition>
                        <Transition DisplayName="ListenerException or UserCancel " sap:VirtualizedContainerService.HintSize="450,514" sap2010:WorkflowViewState.IdRef="Transition_33">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:PointCollection x:Key="ConnectorLocation">760.25,92 760.25,167.04 150.4,167.04 150.4,295</av:PointCollection>
                              <x:Int32 x:Key="SrcConnectionPointIndex">19</x:Int32>
                              <x:Int32 x:Key="DestConnectionPointIndex">30</x:Int32>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Transition.To>
                            <x:Reference>__ReferenceID1</x:Reference>
                          </Transition.To>
                          <Transition.Condition>[FlowException isNot Nothing]</Transition.Condition>
                        </Transition>
                        <Transition DisplayName="Terminar Flujo" sap:VirtualizedContainerService.HintSize="450,514" sap2010:WorkflowViewState.IdRef="Transition_35">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:PointCollection x:Key="ConnectorLocation">720.45,92 720.45,216.04 296,216.04 296,473.95 270,473.95</av:PointCollection>
                              <x:Int32 x:Key="SrcConnectionPointIndex">3</x:Int32>
                              <x:Int32 x:Key="DestConnectionPointIndex">8</x:Int32>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Transition.To>
                            <x:Reference>__ReferenceID0</x:Reference>
                          </Transition.To>
                          <Transition.Condition>[NOT status]</Transition.Condition>
                        </Transition>
                      </State.Transitions>
                    </State>
                  </Transition.To>
                </Transition>
                <Transition DisplayName="Init System Exception" sap:VirtualizedContainerService.HintSize="430,505" sap2010:WorkflowViewState.IdRef="Transition_7">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:PointCollection x:Key="ConnectorLocation">490.45,83 490.45,113 111.2,113 111.2,295</av:PointCollection>
                      <x:Int32 x:Key="SrcConnectionPointIndex">27</x:Int32>
                      <x:Int32 x:Key="DestConnectionPointIndex">14</x:Int32>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Transition.To>
                    <x:Reference>__ReferenceID1</x:Reference>
                  </Transition.To>
                  <Transition.Action>
                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_66">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:String">[strFlujo]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:String">Inicialización</InArgument>
                      </Assign.Value>
                    </Assign>
                  </Transition.Action>
                  <Transition.Condition>[FlowException isNot Nothing]</Transition.Condition>
                </Transition>
              </State.Transitions>
            </State>
          </Transition.To>
        </Transition>
        <Transition DisplayName="Config System Exception" sap:VirtualizedContainerService.HintSize="430,505" sap2010:WorkflowViewState.IdRef="Transition_11">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:PointCollection x:Key="ConnectorLocation">108,58 91.6,58 91.6,295</av:PointCollection>
              <x:Int32 x:Key="SrcConnectionPointIndex">45</x:Int32>
              <x:Int32 x:Key="DestConnectionPointIndex">6</x:Int32>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Transition.To>
            <x:Reference>__ReferenceID1</x:Reference>
          </Transition.To>
          <Transition.Action>
            <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_65">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[strFlujo]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">Carga Configuración</InArgument>
              </Assign.Value>
            </Assign>
          </Transition.Action>
          <Transition.Condition>[FlowException isNot Nothing]</Transition.Condition>
        </Transition>
      </State.Transitions>
    </State>
    <x:Reference>__ReferenceID2</x:Reference>
    <x:Reference>__ReferenceID3</x:Reference>
    <x:Reference>__ReferenceID4</x:Reference>
    <StateMachine.Variables>
      <Variable x:TypeArguments="x:Boolean" Name="status" />
      <Variable x:TypeArguments="s:DateTime" Name="initTime" />
      <Variable x:TypeArguments="s:DateTime" Name="startTime" />
      <Variable x:TypeArguments="s:DateTime" Name="endTime" />
      <Variable x:TypeArguments="ui:GenericValue" Name="timeResult" />
      <Variable x:TypeArguments="x:TimeSpan" Name="elapsedTime" />
      <Variable x:TypeArguments="x:String" Default="[Environment.NewLine]" Name="newLine" />
      <Variable x:TypeArguments="s:Exception" Name="FlowException" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="dicConfig" />
      <Variable x:TypeArguments="x:String" Name="strEndMsg" />
      <Variable x:TypeArguments="sd:Stopwatch" Default="[new Stopwatch()]" Name="swFlujo" />
      <Variable x:TypeArguments="sd:Stopwatch" Default="[new Stopwatch()]" Name="swProceso" />
      <Variable x:TypeArguments="x:String" Name="strFlujo" />
      <Variable x:TypeArguments="x:String" Name="strChoice" />
      <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="listaCorreos" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="dicRobot" />
      <Variable x:TypeArguments="x:String" Name="inMailPassword" />
      <Variable x:TypeArguments="x:String" Name="inMailUser" />
      <Variable x:TypeArguments="x:String" Name="outMailPassword" />
      <Variable x:TypeArguments="x:String" Name="outMailUser" />
      <Variable x:TypeArguments="x:String" Name="SAPPassword" />
      <Variable x:TypeArguments="x:String" Name="SAPUser" />
      <Variable x:TypeArguments="sd1:DataTable" Name="dtCentros" />
      <Variable x:TypeArguments="sd1:DataTable" Name="dtItems" />
      <Variable x:TypeArguments="sd1:DataTable" Name="dtItemAlternativo" />
      <Variable x:TypeArguments="sd1:DataTable" Name="dtOperatorias" />
      <Variable x:TypeArguments="sd1:DataTable" Name="dtOperatoriaAlternativa" />
      <Variable x:TypeArguments="x:String" Default="OK" Name="estatusProcPedido" />
      <Variable x:TypeArguments="x:String" Name="mailCC">
        <Variable.Default>
          <Literal x:TypeArguments="x:String" Value="" />
        </Variable.Default>
      </Variable>
      <Variable x:TypeArguments="x:String" Name="filePedido" />
      <Variable x:TypeArguments="x:String" Name="mensajeProcPedido" />
      <Variable x:TypeArguments="x:String" Name="mailTO" />
      <Variable x:TypeArguments="x:String" Name="tempoFolder" />
      <Variable x:TypeArguments="x:Int32" Default="0" Name="ambitoError" />
      <Variable x:TypeArguments="x:Boolean" Name="boolCorridaPreviaExist" />
    </StateMachine.Variables>
  </StateMachine>
</Activity>